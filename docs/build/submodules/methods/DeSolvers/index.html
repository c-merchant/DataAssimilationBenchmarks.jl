<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>DeSolvers · DataAssimilationBenchmarks</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">DataAssimilationBenchmarks</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">DataAssimilationBenchmarks</span><ul><li><a class="tocitem" href="../../../home/Introduction/">Introduction</a></li><li><a class="tocitem" href="../../../home/Getting Started/">Getting Started</a></li><li><a class="tocitem" href="../../../home/DataAssimilationBenchmarks/">Global Types</a></li></ul></li><li><span class="tocitem">Submodules</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../models/L96/">L96</a></li><li><a class="tocitem" href="../../models/IEEE39bus/">IEEE39bus</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox" checked/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>DeSolvers</a><ul class="internal"><li><a class="tocitem" href="#API-for-differential-equation-solvers"><span>API for differential equation solvers</span></a></li><li><a class="tocitem" href="#Docstrings"><span>Docstrings</span></a></li></ul></li><li><a class="tocitem" href="../EnsembleKalmanSchemes/">EnsembleKalmanSchemes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Experiments</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../experiments/GenerateTimeSeries/">GenerateTimeSeries</a></li><li><a class="tocitem" href="../../experiments/FilterExps/">FilterExps</a></li><li><a class="tocitem" href="../../experiments/SmootherExps/">SmootherExps</a></li><li><a class="tocitem" href="../../experiments/Slurm/">Slurm</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../analysis/ProcessExperimentData/">ProcessExperimentData</a></li><li><a class="tocitem" href="../../analysis/PlotExperimentData/">PlotExperimentData</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Submodules</a></li><li><a class="is-disabled">Methods</a></li><li class="is-active"><a href>DeSolvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>DeSolvers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/cgrudz/DataAssimilationBenchmarks/blob/master/docs/src/submodules/methods/DeSolvers.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Differential-Equation-Solvers"><a class="docs-heading-anchor" href="#Differential-Equation-Solvers">Differential Equation Solvers</a><a id="Differential-Equation-Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Differential-Equation-Solvers" title="Permalink"></a></h1><h2 id="API-for-differential-equation-solvers"><a class="docs-heading-anchor" href="#API-for-differential-equation-solvers">API for differential equation solvers</a><a id="API-for-differential-equation-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#API-for-differential-equation-solvers" title="Permalink"></a></h2><p>Three general schemes are developed for ordinary and stochastic differential equations, the four-stage Runge-Kutta, second order Taylor, and the Euler-(Maruyama) schemes.  Because the second order Taylor-Stratonovich scheme relies specifically on the structure of the Lorenz-96 model with additive noise, this is included separately in the <code>models/L96.jl</code> sub-module.</p><p>General schemes such as the four-stage Runge-Kutta and the Euler-(Maruyama) schemes are built to take in arguments of the form</p><pre><code class="language- hljs">(x::VecA, t::Float64, kwargs::Dict{String,Any})
VecA = Union{Vector{Float64}, SubArray{Float64, 1}}

x            -- array or sub-array of a single state possibly including parameter values
t            -- time point
kwargs       -- this should include dx_dt, the paramters for the dx_dt and optional arguments
dx_dt        -- time derivative function with arguments x and dx_params
dx_params    -- ParamDict of parameters necessary to resolve dx_dt, not including those in the
                extended state vector
h            -- numerical discretization step size
diffusion    -- tunes the standard deviation of the Wiener process, equal to
                sqrt(h) * diffusion
diff_mat     -- structure matrix for the diffusion coefficients, replaces the default
                uniform scaling
state_dim    -- keyword for parameter estimation, dimension of the dynamic state &lt; dimension
                of full extended state
param_sample -- ParamSample dictionary for merging extended state with dx_params
ξ            -- random array size state_dim, can be defined in kwargs to provide a
                particular realization of the Wiener process


# dictionary for model parameters
ParamDict = Union{Dict{String, Array{Float64}}, Dict{String, Vector{Float64}}}

# dictionary containing key and index pairs to subset the state vector
# and merge with dx_params
ParamSample = Dict{String, Vector{UnitRange{Int64}}}
</code></pre><p>with reduced options for the less-commonly used first order Euler(-Maruyama) scheme.</p><p>The time steppers over-write the value of <code>x</code> in place as a vector or a view of an array for efficient ensemble integration. We follow the convention in data assimilation of the extended state formalism for parameter estimation where the parameter sample should be included as trailing state variables in the columns of the ensemble array.  If</p><pre><code class="language- hljs">true == haskey(kwargs, &quot;param_sample&quot;)</code></pre><p>the <code>state_dim</code> parameter will specify the dimension of the dynamical states and create a view of the vector <code>x</code> including all entries up to this index.  The remaining entries in the vector <code>x</code> will be passed to the <code>dx_dt</code> function in a dictionary merged with the <code>dx_params</code> dictionary, according to the param<em>sample indices and parameter values specified in `param</em>sample<code>. The parameter sample values will remain unchanged by the time stepper when the dynamical state entries in</code>x` are over-written in place.</p><p>Setting <code>diffusion &gt; 0.0</code> above introduces additive noise to the dynamical system.  The main <code>rk4_step!</code> has convergence on order 4.0 when diffusion is equal to zero, and both strong and weak convergence on order 1.0 when stochasticity is introduced.  Nonetheless, this is the recommended out-of-the-box solver for any generic DA simulation for the statistically robust performance, versus Euler-(Maruyama). When specifically generating the truth-twin for the Lorenz-96 model with additive noise, this should be performed with the <code>l96s_tay2_step!</code> in the <code>models/L96.jl</code> sub-module while the ensemble should be generated with the <code>rk4_step!</code>. See the benchmarks on the <a href="https://gmd.copernicus.org/articles/13/1903/2020/">L96-s model</a> for a full discussion of statistically robust model configurations.</p><h2 id="Docstrings"><a class="docs-heading-anchor" href="#Docstrings">Docstrings</a><a id="Docstrings-1"></a><a class="docs-heading-anchor-permalink" href="#Docstrings" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DataAssimilationBenchmarks.DeSolvers.em_step!-Tuple{Vector{Float64}, Float64, Dict{String, Any}}" href="#DataAssimilationBenchmarks.DeSolvers.em_step!-Tuple{Vector{Float64}, Float64, Dict{String, Any}}"><code>DataAssimilationBenchmarks.DeSolvers.em_step!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">em_step!(x::Vector{Float64}, t::Float64, kwargs::Dict{String,Any})</code></pre><p>This will propagate the state x one step forward by Euler-Murayama scheme. Step size is h, the Wiener process is assumed to have a scalar diffusion coefficient.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgrudz/DataAssimilationBenchmarks/blob/125b866c46adc3abceff585eef2763960eabc5c3/src/methods/DeSolvers.jl#L150-L155">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DataAssimilationBenchmarks.DeSolvers.rk4_step!-Tuple{Union{SubArray{Float64, 1}, Vector{Float64}}, Float64, Dict{String, Any}}" href="#DataAssimilationBenchmarks.DeSolvers.rk4_step!-Tuple{Union{SubArray{Float64, 1}, Vector{Float64}}, Float64, Dict{String, Any}}"><code>DataAssimilationBenchmarks.DeSolvers.rk4_step!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rk4_step!(x::VecA, t::Float64, kwargs::Dict{String,Any})</code></pre><p>Step of integration rule for 4 stage Runge-Kutta as discussed in Grudzien et al. 2020. The rule has strong convergence order 1.0 for generic SDEs and order 4.0 for ODEs. Arguments are given as:</p><pre><code class="nohighlight hljs">x            -- array or sub-array of a single state possibly including parameter values
t            -- time point
kwargs       -- should include dx_dt, the paramters for the dx_dt and optional arguments
dx_dt        -- time derivative function with arguments x and dx_params
dx_params    -- parameters necessary to resolve dx_dt, not including
                parameters to be estimated in the extended state vector 
h            -- numerical discretization step size
diffusion    -- tunes the standard deviation of the Wiener process, 
                equal to sqrt(h) * diffusion
diff_mat     -- structure matrix for the diffusion coefficients,
                replaces the default uniform scaling 
state_dim    -- keyword for parameter estimation, dimension of the
                dynamic state &lt; dimension of full extended state
param_sample -- ParamSample dictionary for merging extended state with dx_params
ξ            -- random array size state_dim, can be defined in kwargs
                to provide a particular realization for method validation</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgrudz/DataAssimilationBenchmarks/blob/125b866c46adc3abceff585eef2763960eabc5c3/src/methods/DeSolvers.jl#L9-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DataAssimilationBenchmarks.DeSolvers.tay2_step!-Tuple{Vector{Float64}, Float64, Dict{String, Any}}" href="#DataAssimilationBenchmarks.DeSolvers.tay2_step!-Tuple{Vector{Float64}, Float64, Dict{String, Any}}"><code>DataAssimilationBenchmarks.DeSolvers.tay2_step!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">tay2_step!(x::Vector{Float64}, t::Float64, kwargs::Dict{String,Any})</code></pre><p>Deterministic second order (autonomous) Taylor method for step size h and state vector x. Time variable t is just a dummy variable, where this method is not defined for non-autonomous dynamics.  Arguments are given as     x          – array of a single state possibly including parameter values     kwargs     – should include dx<em>dt, the paramters for the dx</em>dt and optional arguments     dx<em>dt      – time derivative function with arguments x and dx</em>params     dx<em>params  – parameters necessary to resolve dx</em>dt, not including                   parameters to be estimated in the extended state vector      h          – numerical discretization step size</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgrudz/DataAssimilationBenchmarks/blob/125b866c46adc3abceff585eef2763960eabc5c3/src/methods/DeSolvers.jl#L120-L132">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../models/IEEE39bus/">« IEEE39bus</a><a class="docs-footer-nextpage" href="../EnsembleKalmanSchemes/">EnsembleKalmanSchemes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Friday 8 April 2022 16:24">Friday 8 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
